<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文字列操作</title>
</head>
<body>

    <!-- ユーザーが指定した数のセクションを作成 -->
    <label for="sectionCount">セクションの数:</label>
    <input type="number" id="sectionCount" min="1" value="1">
    <button onclick="updateSections()">更新</button>

    <div id="sectionsContainer"></div>

    <button onclick="processText()">実行</button>
    <button onclick="copyResult()">コピー</button>

    <p id="result"></p>

    <script>
        var sectionCount = 1; // ページロード時の初期値

        function updateSections() {
            sectionCount = document.getElementById("sectionCount").value;
            createSections(sectionCount);
        }

        function createSections(count) {
            var container = document.getElementById("sectionsContainer");
            container.innerHTML = "";

            for (var i = 1; i <= count; i++) {
                var section = document.createElement("section");

                var label = document.createElement("label");
                label.setAttribute("for", "inputText" + i);
                label.textContent = "文字列" + i + ":";

                var input = document.createElement("input");
                input.setAttribute("type", "text");
                input.setAttribute("id", "inputText" + i);

                var select = document.createElement("select");
                select.setAttribute("id", "operationOption" + i);

                var encodeOption = document.createElement("option");
                encodeOption.setAttribute("value", "encode");
                encodeOption.textContent = "エンコード";

                var decodeOption = document.createElement("option");
                decodeOption.setAttribute("value", "decode");
                decodeOption.textContent = "デコード";

                var noOperationOption = document.createElement("option");
                noOperationOption.setAttribute("value", "noOperation");
                noOperationOption.textContent = "何もしない";

                select.appendChild(encodeOption);
                select.appendChild(decodeOption);
                select.appendChild(noOperationOption);

                section.appendChild(label);
                section.appendChild(input);
                section.appendChild(select);

                container.appendChild(section);
            }
        }
    </script>

    <script>
        function processText() {
            var textToDisplay = "";

            for (var i = 1; i <= sectionCount; i++) {
                // ユーザーが指定した文字列と操作のオプションを取得
                var text = getTextWithOperation("inputText" + i, "operationOption" + i);
                textToDisplay += text;
            }

            // 文字列を処理して表示
            var resultElement = document.getElementById("result");
            resultElement.textContent = "結果: " + textToDisplay;
        }

        function copyResult() {
            // 結果をコピー
            var resultElement = document.getElementById("result");
            var resultText = resultElement.textContent;

            // コピー用のテキストエリアを作成して値をセット
            var copyTextArea = document.createElement("textarea");
            copyTextArea.value = resultText;

            // テキストエリアをページに追加
            document.body.appendChild(copyTextArea);

            // テキストエリアの選択とコピー
            copyTextArea.select();
            document.execCommand("copy");

            // テキストエリアを削除
            document.body.removeChild(copyTextArea);

            alert("コピーが成功しました: " + resultText);
        }

        function getTextWithOperation(textInputId, operationOptionId) {
            // ユーザーが指定した文字列を取得
            var inputElement = document.getElementById(textInputId);
            var textToProcess = inputElement.value;

            // 操作のオプションを取得
            var operationOptionElement = document.getElementById(operationOptionId);
            var operationOption = operationOptionElement.value;

            // 操作の選択に応じて文字列を処理
            if (operationOption === "encode") {
                textToProcess = encodeURIComponent(textToProcess);
            } else if (operationOption === "decode") {
                textToProcess = decodeURIComponent(textToProcess);
            }

            return textToProcess;
        }
    </script>

</body>
</html>
